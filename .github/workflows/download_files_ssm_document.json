{
    "schemaVersion": "2.2",
    "description": "Download Files Script",
    "mainSteps": [
      {
        "action": "aws:runShellScript",
        "name": "non-git-os-files",
        "inputs": {
          "runCommand": [
            "#!/bin/bash",
            "BASE_DIR=\"/home/sguser\"",
            "declare -A IMAGE_MAPPING",
            "IMAGE_MAPPING=( [\"https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip\"]=\"ami-cli\" )",
            "download_url() {",
            "  url=$1",
            "  image_name=${IMAGE_MAPPING[\"$url\"]}",
            "  if [ ! -d \"$BASE_DIR/$image_name\" ]; then",
            "    mkdir -p \"$BASE_DIR/$image_name\"",
            "    wget -P \"$BASE_DIR/$image_name\" $url",
            "  else",
            "    echo \"Skipping $url. Subdirectory already exists.\"",
            "  fi",
            "}",
            "export -f download_url",
            "echo \"${!IMAGE_MAPPING[@]}\" | xargs -n 1 -P 0 -I {} bash -c 'download_url \"{}\"'",
            "exit 0"
          ]
        }
      }
    ]
  }
